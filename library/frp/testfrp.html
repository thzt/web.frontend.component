<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>

    <script src="frp.js"></script>
</head>

<body>
    <script>
        (function(){
            let cso=window.createStreamOperator;

            let stream1=cont=>{
                let i=0;
                while(++i){
                    if(i>10){
                        break;
                    }
                    cont(i);
                }
            };

            let map=cso((val,fn,cont)=>cont(fn(val)));
            let filter=cso((val,fn,cont)=>{
                if(!fn(val)){
                    return;
                }
                cont(val);
            });
            let merge=cso((val,fn,cont)=>cont(val));

            let stream2=filter(x=>x%2!=0,stream1);
            let stream3=map(x=>x*x,stream1);
            let stream4=merge(()=>{},stream2,stream3);

            stream4(x=>console.log(x));
        }());
    </script>

</body>

</html>